# Exploits README

This `README.md` explains how to get started on using the `Metasploit` to run the security exploit

[Metasploit link for the exploit](https://www.rapid7.com/db/modules/exploit/linux/http/nginx_chunked_size/)

## Useful links

[Ruby install link](https://www.digitalocean.com/community/tutorials/how-to-install-ruby-on-rails-with-rbenv-on-ubuntu-20-04) - Highly recommended to use the `rbenv` if you need to do anything with Ruby

[Metasploit install link](https://docs.metasploit.com/docs/using-metasploit/getting-started/nightly-installers.html) 

[GitHub](https://github.com/polyverse/vuln-nginx-1.4.0)

[Metasploit Unleashed](https://www.offsec.com/metasploit-unleashed/)

[Bropper](https://github.com/Hakumarachi/Bropper)

## Instructions for `Bropper`
1. For the original example, simple run `docker build -t bropper:ex_2_old .` in the `orig` folder. 
2. To execute the original example, run `docker run -it -p 1337:1337 bropper:ex_2_old`.
3. Then run the exploit in the `Bropper` repository (submodule); The command used is: `python3 bropper.py -t 127.0.0.1 -p 1337 --wait "Password :" --expected Bad --expected-stop Welcome -o dump`.
---
1. For the `IBCS` example, we first need to create `ibcs.new` and the file exists in the `$HOME/IBCS/results/bropper_ex_2` directory (e.g., this will need to be done via `bash ibcs.sh bropper_ex_2` and rewrite the directory).
2. `bash build.sh` will build the docker container.
3. Then run the docker container `docker run -it -p 1337:1337 bropper:ex_2_new`.
4. Lastly, run the exploit similar to above.

Note: If port issues occur, it may be because the command `lsof -t -i:1337` didnâ€™t detect this because lsof typically shows host-level processes, while Docker containers may not be directly visible in the same way unless inspected specifically.

## Instructions for NGINX (Doesn't work)
1. Need to install the Metasploit using the above link provided. Highly recommended to clean up the installation of `Ruby` with `rbenv`.
2. `docker run -it -p 80:80 --rm --name base-nginx-1.4.0-32 polyverse/vuln 
erable-nginx-1.4.0:base` (This will run the Docker container containing the nginx-1.4.0).
3. `docker exec -it base-nginx-1.4.0-32 /bin/bash` this will allow you to hook into executing container.
4. `ps aux` will show the nginx running and `/opt/bin/gdb -p 1` will hook the process (PID) onto the gdb, where now it is possible to run `continue`.
